# 一、基本框架搭建

## 1、欢迎页面

```kotlin
class LauncherActivity : AppCompatActivity() {

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_launcher)

        Handler().postDelayed({
            startHomeActivity()
        },1000)
    }

    private fun startHomeActivity() {
        startActivity(Intent(this,HomeActivity::class.java))
        // 关闭当前页面
        finish()
    }
}
```

## 2、主页面

主页面布局

```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical">

    <!-- 标题栏 -->
    <include layout="@layout/titlebar" />

    <!-- FrameLayout -->
    <FrameLayout
        android:id="@+id/fl_content"
        android:layout_width="match_parent"
        android:layout_height="0dp"
        android:layout_weight="1" />

    <!-- 底部的RadioGroup -->
    <RadioGroup
        android:id="@+id/rg_main"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:background="#11000000"
        android:gravity="center_vertical"
        android:orientation="horizontal"
        android:padding="5dp">

        <RadioButton
            android:id="@+id/rb_common_frame"
            style="@style/bottom_tag_style"
            android:drawableTop="@drawable/rb_common_frame_drawable_selector"
            android:text="常用框架" />

        <RadioButton
            android:id="@+id/rb_thirdparth_frame"
            style="@style/bottom_tag_style"
            android:drawableTop="@drawable/rb_thirdparty_frame_drawable_selector"
            android:text="第三方" />

        <RadioButton
            android:id="@+id/rb_custom_frame"
            style="@style/bottom_tag_style"
            android:drawableTop="@drawable/rb_custom_frame_drawable_selector"
            android:text="自定义控件" />

        <RadioButton
            android:id="@+id/rb_other_frame"
            style="@style/bottom_tag_style"
            android:drawableTop="@drawable/rb_other_frame_drawable_selector"
            android:text="其它" />
    </RadioGroup>
</LinearLayout>
```

标题栏：titlebar.xml

```xml
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="50dp"
    android:background="@android:color/holo_blue_light"
    android:gravity="center"
    android:orientation="vertical">

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:gravity="center"
        android:text="Android知识复习"
        android:textColor="@android:color/white"
        android:textSize="20sp" />

</LinearLayout>
```

底部样式：

```xml
<style name="bottom_tag_style">
        <item name="android:layout_width">wrap_content</item>
        <item name="android:layout_height">wrap_content</item>
        <item name="android:layout_weight">1</item>

        <item name="android:button">@android:color/transparent</item>
        <item name="android:drawablePadding">3dp</item>
        <item name="android:textSize">10sp</item>
        <item name="android:textColor">@drawable/bottom_textcolor_drawable_selector</item>
        <item name="android:gravity">center</item>
    </style>
```

drawable：

```xml
// 文字颜色
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">

    <item android:state_checked="true" android:color="#1296db"/>
    <item android:state_checked="false" android:color="#363636"/>
</selector>


// 图片
<?xml version="1.0" encoding="utf-8"?>
<selector xmlns:android="http://schemas.android.com/apk/res/android">

    <item android:drawable="@drawable/ic_other_press" android:state_checked="true" />
    <item android:drawable="@drawable/ic_other" android:state_checked="false" />
</selector>
```



## 3、Fragment页面切换

```kotlin
class HomeActivity : FragmentActivity() {

    lateinit var mRgMain: RadioGroup
    lateinit var baseFragments: MutableList<BaseFragment>
    var mContent: Fragment? = null
    var position = 0


    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_home)

        initFragment() // 必须提前调用，否则提示lateinit property 未初始化问题

        initView()
    }

    private fun initFragment() {
        baseFragments = mutableListOf()
        baseFragments.add(CommonFrameFragment())
        baseFragments.add(ThirdPartyFrameFragment())
        baseFragments.add(CustomFrameFragment())
        baseFragments.add(OtherFrameFragment())
    }

    private fun initView() {
        mRgMain = findViewById<RadioGroup>(R.id.rg_main)

        // 外层{} 表示lambda，
        mRgMain.setOnCheckedChangeListener { group, id ->

            when (id) {
                R.id.rb_common_frame -> position = 0
                R.id.rb_thirdparth_frame -> position = 1
                R.id.rb_custom_frame -> position = 2
                R.id.rb_other_frame -> position = 3
            }

            var baseFragment = getFragment()
//            switchFragment(baseFragment)
            switchFragment(mContent, baseFragment)
        }

        mRgMain.run {
            check(R.id.rb_common_frame)
        }
    }

    private fun switchFragment(from: Fragment?, to: Fragment) {
        if (from != to) {

            var transaction = supportFragmentManager.beginTransaction()

            // 先隐藏当前fragment
            from?.run {
                transaction.hide(from)  // hide 不用commit，否则commit already called
            }


            to?.isAdded().run {
                // 如果已经添加直接显示
                if (this) {
                    transaction.show(to).commit()
                } else { // 没有添加先添加
                    transaction.add(R.id.fl_content, to).commit()
                }
            }
            mContent = to
        }
    }

    private fun getFragment(): BaseFragment {
        return baseFragments.get(position)
    }

    // 使用replace 每次都会销毁容器中所有的fragment，效率低
    private fun switchFragment(fragment: BaseFragment) {
        var transaction = supportFragmentManager.beginTransaction()
        transaction.replace(R.id.fl_content, fragment)
            .commit()
    }
}
```

## 4、横竖屏切换导致重叠问题

```xml
<activity
            android:name=".HomeActivity"
            android:configChanges="orientation|screenSize|keyboardHidden" />
```





# 二、OkHttp

优点：快（同一主机单个Socket，连接池减少请求延迟）、省带宽（GZIP、Cache）

支持连接同一地址的链接共享同一个socket，通过连接池来减少响应延迟，还有透明的GZIP压缩，请求延缓等优势，其核心主要有路由、连接协议、拦截器、代理、安全性认证、连接池以及网络适配，拦截器主要是指添加、移除或者转换请求或者回应的头部信息

主要功能：

1、请求文本数据

2、大文件上传、下载

3、请求图片

## 1、

